<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Exercise: Git branching</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <style>
    body {
      font-family: system-ui, sans-serif;
      margin: 2rem auto;
      max-width: 750px;
      padding: 1rem;
      background-color: #fefefe;
      color: #333;
    }
    h1, h2, h3 {
      color: #006e58;
    }
    code {
      background: #f4f4f4;
      padding: 2px 4px;
      border-radius: 4px;
    }
    pre {
      background: #f4f4f4;
      padding: 1rem;
      overflow-x: auto;
      border-radius: 4px;
    }
    table {
      width: 100%;
      border-collapse: collapse;
      margin: 1rem 0;
    }
    th, td {
      border: 1px solid #ddd;
      padding: 0.5rem;
    }
    th {
      background-color: #f0f0f0;
    }
    img {
      max-width: 100%;
      height: auto;
    }
  </style>
</head>
<body>
  <h1 id="exercise-git-branching">Exercise: Git branching</h1>
  <p><img src="https://img.shields.io/badge/Offered%20by-%20Digital%20Work%20(Otto--Friedrich--Universit%C3%A4t%20Bamberg)-blue" alt="Offered by: Digital Work at Otto-Friedrich-Universität Bamberg" /> <img src="https://img.shields.io/badge/License-CC%20BY%204.0-green.svg" alt="License: CC BY 4.0" /></p>
  <p style="max-width: 730px; margin-left: 0; margin-right: 0; text-align: justify;">
  <img src="../../material/iconmonstr-certificate-6.svg" alt="Edit" width="16" height="16"> The notebook builds on our peer-reviewed <a href="https://digital-work-lab.github.io/rethink-git-teaching/">pedagogical foundations</a>. The interactive visualization and tutorial are based on the amazing <a href="https://github.com/pcottle/learnGitBranching">learnGitBranching</a> repository.
  </p>
  <p style="max-width: 730px; margin-left: 0; margin-right: 0; text-align: justify;">
  We <img src="../../material/iconmonstr-favorite-2.svg" alt="Edit" width="12" height="12"> your <a href="https://github.com/digital-work-lab/practice-git/issues/new/choose" target="_blank">feedback</a> and <a href="https://github.com/digital-work-lab/practice-git/edit/main/notebooks/git_committing.ipynb" target="_blank">suggestions</a> on this notebook!
  </p>
  <hr />
  <div style="border-left: 4px solid #026e57; background-color: #d0f0e4; padding: 15px; margin: 10px 0; color: #026e57; border-radius: 5px; width:730px;">
  <pre><code>&lt;strong&gt;Concepts: Git branching&lt;/strong&gt; &lt;br&gt;&lt;br&gt;The slides explaining Git branching are &lt;a href=&quot;../output/02-git.html#part-1-branching&quot; target=&quot;_blank&quot;&gt;here&lt;/a&gt;.</code></pre>
  </div>
  <p>With this notebook, you can practice branching in Git.</p>
  <table>
  <thead>
  <tr class="header">
  <th>Practice</th>
  <th>Label</th>
  <th>Time (min)</th>
  </tr>
  </thead>
  <tbody>
  <tr class="odd">
  <td>1</td>
  <td><a href="#basics">Commit, branch, merge, rebase</a></td>
  <td>23</td>
  </tr>
  <tr class="even">
  <td>2</td>
  <td><a href="#branch">Branching strategies</a></td>
  <td>5</td>
  </tr>
  <tr class="odd">
  <td>3</td>
  <td><a href="#merge">Merge methods</a></td>
  <td>40</td>
  </tr>
  <tr class="even">
  <td>4</td>
  <td><a href="#wrap-up">Wrap-up</a></td>
  <td>2</td>
  </tr>
  <tr class="odd">
  <td></td>
  <td><strong>Overall</strong></td>
  <td><strong>70</strong></td>
  </tr>
  </tbody>
  </table>
  <p><img src="../../material/iconmonstr-certificate-6.svg" alt="Edit" width="12" height="12"> We are here to help if errors or questions come up!</p>
  <hr />
  <h2 id="part-1-commit-branch-merge-rebase">Part 1: Commit, branch, merge, rebase <a id="basics"></a></h2>
  <p>We have covered <code>git commit</code>, as well as <code>git branch</code>, <code>git switch</code>, and <code>git merge</code> operations in the lecture.</p>
  <p><strong>Task</strong>: To practice branching and manipulating the Git graph, complete level 1 (introduction) of the <a href="https://learngitbranching.js.org/?locale=en_EN">learngitbranching</a>{: target=“_blank”} tutorial.</p>
  <p>Hints:</p>
  <ul>
  <li>You can always type <code>undo</code> to undo the last command</li>
  <li>You can run <code>git commit</code> without specifying a commit message.</li>
  </ul>
  <!--
  To start the tutorial, run the following code cell and confirm the environment.
  from IPython.display import IFrame

  IFrame('https://learngitbranching.js.org/', width=1400, height=800)
  -->
  <h3 id="optional-challenge">Optional Challenge</h3>
  <p>If you have completed Part 1 quickly, you may continue practicing with the following challenge.</p>
  <p><strong>Task</strong>: To continue practicing, create the following tree, which resembles a typical setup of Git branches. To do this, you can open <a href="https://learngitbranching.js.org/?locale=en_EN">learngitbranching</a>{: target=“_blank”} in a separate window.</p>
  <p><img src="../../material/git-branches.png" style="width: 600px;" alt="Git branches"/></p>
  <div style="clear: both;">

  </div>
  <p><br></p>
  <details>
  <summary>
  Solution
  </summary>
  <p>The following commands produce this particular graph:</p>
  <pre class="highlight">git commit
  git commit
  git commit
  git checkout c1
  git checkout-b hotfix
  git commit
  git checkout main
  git merge hotfix
  git checkout c1
  git checkout -b dev
  git commit
  git commit
  git checkout c6
  git checkout -b feature
  git commit
  git commit
  git checkout dev
  git merge feature
  git checkout main
  git merge dev</pre>
  </details>
  <div class="page-break">

  </div>
  <h2 id="part-2-branching-strategies">Part 2: Branching strategies <a id="branch"></a></h2>
  <p>Analyze the Git graph with the different branches. Explain what happens as the project progresses.</p>
  <!--
  - Branching strategies (have students examine repositories with different branching strategies)
  -->
  <p><img src="../../material/git-flow.png" width="800"/></p>
  <div style="clear:both;">

  </div>
  <details>
  <summary>
  Solution
  </summary>
  <ul>
  <li>
  The project has two parallel branches: <strong>Main</strong> and <strong>Develop</strong>. <strong>Main</strong> has stable releases and urgent hotfixes (e.g., to fix bugs).
  </li>
  <li>
  The <strong>Develop</strong> branch contains the development activity, more complex tasks are completed in separate <strong>Feature</strong> branches (one has been merged, another may be under development or be stalled.) Hotfixes are also integrated into the <strong>Develop</strong> branch.
  </li>
  <li>
  To release new versions, the developers create a branch from <strong>Develop</strong>, do some pre-release work, and eventually merge it into <strong>Main</strong>.
  </li>
  <li>
  This setup ensures that the <strong>Main</strong> branch is stable and unaffected by untested code.
  </li>
  </ul>
  </details>
  <h2 id="part-3-merge-methods">Part 3: Merge methods <a id="merge"></a></h2>
  <p>This part focuses on different methods to integrate changes from one branch into another (aka. “merge methods”).</p>
  <p>When running <code>git merge other-branch</code>, there are two options:</p>
  <ul>
  <li>If two branches have <b>not diverged</b>, Git will perform a <b>fast-forward merge</b>:</li>
  </ul>
  <p><img src="../../material/fast-forward-merge.gif" width="730px"></p>
  <ul>
  <li>A more common case is when two branches have <strong>diverged</strong>, i.e., each branch has commits that the other branch does not have. In this case, Git will create a merge commit:</li>
  </ul>
  <p><img src="../../material/merge-commit.gif" width="730px"></p>
  <p>In addition to <code>git merge</code>, users also have the option to <strong>rebase</strong> changes. This preserves a <strong>linear</strong> version history* in the target branch instead of cluttering it with an array of merge commits:</p>
  <!-- https://www.atlassian.com/git/tutorials/merging-vs-rebasing -->
  <p><img src="../../material/merge-rebase.gif" width="730px"></p>
  <!-- 
  - Squash the changes (not available as a learngitbranching animation)

  Note: GitHub offers these options to merge pull requests:

  <img src="../../material/github-pull-request.png" width="730px">
  -->
  <p>There is another option: to <strong>squash</strong> changes from another branch. This effectively combines all changes from the other branch in a single commit, which is added on top of the target branch.</p>
  <p>We will now practice the different methods in a real Git repository.</p>
  <p><strong>Task</strong>: Start GitHub Codespaces from the <a href="https://github.com/CoLRev-Environment/colrev">CoLRev repository</a>{: target=“_blank”} and set up the <code>quality_model_docs</code> branch, using the following commands.</p>
  <div class="sourceCode" id="cb2"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>cd <span class="op">/</span>workspaces<span class="op">/</span>colrev</span>
  <span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>git checkout <span class="dv">108</span><span class="er">d278e8d01a65c5128c4a880247f0272896059</span></span>
  <span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>git switch <span class="op">-</span>c quality_model_docs</span>
  <span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Remove the origin for better readability of the Git viewer</span></span>
  <span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a>git remote remove origin</span></code></pre></div>
  <div style="border: 2px solid #ff9800; padding: 10px; background-color: #ffe0b2; color: #e65100; border-radius: 5px; display: inline-block; width: fit-content; width:730px;">
  <pre><code>&lt;strong&gt;Important:&lt;/strong&gt; Make sure to copy the commands and enter them in the shell as shown in the screenshot. It is not possible to run the cells in this notebook.
  &lt;div style=&quot;clear: both;&quot;&gt;&lt;/div&gt;
  &lt;img src=&quot;../../material/codespace-shell.png&quot; width=&quot;800&quot;/&gt;</code></pre>
  </div>
  <p><strong>Task</strong>: Go through the following options, and run the commands. Take notes on the Git graph, i.e., the structure and IDs of commits, by completing the three Git graphs (you can open the page as a <a href="../../material/overview-task.pdf">PDF</a>):</p>
  <p><img src="../../material/overview-task.png" width="800"/></p>
  <p>To analyze the specific changes, open the Git GUI:</p>
  <p><img src="../../material/codespace-git-viewer-rebase.png" width="800"/></p>
  <h3 id="option-1-merge-commit">Option 1: Merge commit</h3>
  <div class="sourceCode" id="cb4"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>git switch main</span>
  <span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>git reset <span class="op">--</span>hard  <span class="dv">6</span><span class="er">f4299bdb0551c680a97dbe04b39dee51bcd0556</span></span>
  <span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>git merge quality_model_docs</span></code></pre></div>
  <p>Wait until the Git viewer is refreshed to display the merge commit and extract the commit SHAs.</p>
  <h3 id="option-2-rebase">Option 2: Rebase</h3>
  <div class="sourceCode" id="cb5"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>git switch main</span>
  <span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>git reset <span class="op">--</span>hard  <span class="dv">6</span><span class="er">f4299bdb0551c680a97dbe04b39dee51bcd0556</span></span>
  <span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>git switch quality_model_docs</span>
  <span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>git rebase main</span>
  <span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a>git switch main</span>
  <span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a>git merge quality_model_docs</span></code></pre></div>
  <h3 id="option-3-squash">Option 3: Squash</h3>
  <div class="sourceCode" id="cb6"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>git switch main</span>
  <span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>git reset <span class="op">--</span>hard  <span class="dv">6</span><span class="er">f4299bdb0551c680a97dbe04b39dee51bcd0556</span></span>
  <span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>git merge <span class="op">--</span>squash quality_model_docs</span>
  <span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a>git commit <span class="op">-</span>n <span class="op">-</span>m <span class="st">&#39;update docs for quality_model&#39;</span></span></code></pre></div>
  <p><strong>Task</strong>: Compare the three Git graphs and the commit IDs. What are the differences between the three methods in terms of the contents of commits and their metadata?</p>
  <details>
  <summary>
  Solution
  </summary>
  <ul>
  <li>
  In method 1 (merge commit), there is one merge commit with two predecessors.
  </li>
  <li>
  In method 2 (rebase), the individual commits from the quality branch are “replayed” on top of the main branch.
  </li>
  <li>
  In method 3 (squash), all changes from the original quality branch are combined in a single commit, which is added on top of the main branch.
  </li>
  <li>
  The contents of the last commit are identical across all three methods.
  </li>
  <li>
  Each of the new commits has your account as the author and the current date.
  </li>
  </ul>
  <p><b>Note:</b> All three methods change the state of the <code>main</code> branch. None changes the state of the <code>quality</code> branch. The commit IDs in your solution will differ.</p>
  <p><img src="../../material/overview-task_solution.png" width="800"/></p>
  </details>
  <p><strong>Question</strong>: Why does the merge commit always have a different ID if another student creates it or if you run the same commands a few seconds later?</p>
  <details>
  <summary>
  Solution
  </summary>
  <p>The commit object always contains the commit author and date. If they differ, Git generates a different commit SHA from the content and metadata.</p>
  </details>
  <p><strong>Note</strong>: You can use the merge methods in a Codespace environment (as you just did), in a local Git repository, and even online on GitHub:</p>
  <p><img src="../../material/pull-request-options.png" width="800"/></p>
  <h2 id="wrap-up">Wrap-up <a id="wrap-up"></a></h2>
  <p>🎉🎈 You have completed the Git branching notebook - good work! 🎈🎉</p>
  <p>In this notebook, we have learned</p>
  <ul>
  <li>To create a given Git graph using the <code>git commit</code>, <code>git branch</code>, <code>git switch</code>, and <code>git merge</code> commands</li>
  <li>To explain typical branching strategies</li>
  <li>The differences between merge commits, rebases, and squashed merges</li>
  </ul>
</body>
</html>
