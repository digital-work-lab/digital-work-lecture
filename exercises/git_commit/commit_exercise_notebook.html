<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Git committing</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <style>
    body {
      font-family: system-ui, sans-serif;
      margin: 2rem auto;
      max-width: 750px;
      padding: 1rem;
      background-color: #fefefe;
      color: #333;
    }
    h1, h2, h3 {
      color: #006e58;
    }
    code {
      background: #f4f4f4;
      padding: 2px 4px;
      border-radius: 4px;
    }
    pre {
      background: #f4f4f4;
      padding: 1rem;
      overflow-x: auto;
      border-radius: 4px;
    }
    table {
      width: 100%;
      border-collapse: collapse;
      margin: 1rem 0;
    }
    th, td {
      border: 1px solid #ddd;
      padding: 0.5rem;
    }
    th {
      background-color: #f0f0f0;
    }
    img {
      max-width: 100%;
      height: auto;
    }
  </style>
</head>
<body>
  <h1 id="exercise-notebook-git-committing">Exercise notebook: Git committing</h1>
  <p><img src="https://img.shields.io/badge/Offered%20by-%20Digital%20Work%20(Otto--Friedrich--Universit%C3%A4t%20Bamberg)-blue" alt="Offered by: Digital Work at Otto-Friedrich-Universität Bamberg" /> <img src="https://img.shields.io/badge/License-CC%20BY%204.0-green.svg" alt="License: CC BY 4.0" /></p>
  <p><img src="../../material/iconmonstr-certificate-6.svg" alt="Edit" width="16" height="16"> The notebook builds on our peer-reviewed <a href="https://digital-work-lab.github.io/rethink-git-teaching/">pedagogical foundations</a>.</p>
  <p>We <img src="../../material/iconmonstr-favorite-2.svg" alt="Edit" width="12" height="12"> your <a href="https://github.com/digital-work-lab/practice-git/issues/new/choose" target="_blank">feedback</a> and <a href="https://github.com/digital-work-lab/practice-git/edit/main/notebooks/git_committing.ipynb" target="_blank">suggestions</a> on this notebook!</p>
  <hr />
  <div style="border-left: 4px solid #026e57; background-color: #d0f0e4; padding: 15px; margin: 10px 0; color: #026e57; border-radius: 5px; width:730px;">
  <pre><code>&lt;strong&gt;Concepts: Git areas&lt;/strong&gt; &lt;br&gt;&lt;br&gt;The slides explaining the Git areas are &lt;a href=&quot;../output/02-git.html#part-2-committing&quot; target=&quot;_blank&quot;&gt;here&lt;/a&gt;.</code></pre>
  </div>
  <p><br></p>
  <p>With this notebook, you can practice committing changes in Git.</p>
  <table>
  <thead>
  <tr class="header">
  <th>Practice</th>
  <th>Label</th>
  <th>Time (min)</th>
  </tr>
  </thead>
  <tbody>
  <tr class="odd">
  <td>1</td>
  <td><a href="#clone">Clone the repository</a></td>
  <td>5</td>
  </tr>
  <tr class="even">
  <td>2</td>
  <td><a href="#commit">Create, stage, and commit changes</a></td>
  <td>10</td>
  </tr>
  <tr class="odd">
  <td>3</td>
  <td><a href="#undo">Undo committed changes</a></td>
  <td>8</td>
  </tr>
  <tr class="even">
  <td>4</td>
  <td><a href="#atomic">Create Atomic commits</a></td>
  <td>10</td>
  </tr>
  <tr class="odd">
  <td>5</td>
  <td><a href="#undo">Undo changes (advanced)</a></td>
  <td>5</td>
  </tr>
  <tr class="even">
  <td>6</td>
  <td><a href="#wrap-up">Wrap-up</a></td>
  <td>2</td>
  </tr>
  <tr class="odd">
  <td></td>
  <td>Overall</td>
  <td>40</td>
  </tr>
  </tbody>
  </table>
  <p><img src="../../material/iconmonstr-certificate-6.svg" alt="Edit" width="12" height="12"> We are here to help if errors or questions come up!</p>
  <p><br></p>
  <hr />
  <h2 id="part-1-set-up-the-repository">Part 1: Set up the repository <a id="clone"></a></h2>
  <p><strong>Task</strong>: Start GitHub Codespaces from the <a href="https://github.com/CoLRev-Environment/colrev">CoLRev repository</a>{: target=“_blank”}.</p>
  <p><strong>Note</strong>: To create an empty git project, you would run <code>git init</code>.</p>
  <div style="border: 2px solid #ff9800; padding: 10px; background-color: #ffe0b2; color: #e65100; border-radius: 5px; display: inline-block; max-width: 800px; width: 100%;">
  <pre><code>&lt;strong&gt;Important:&lt;/strong&gt; Make sure to copy the commands and enter them in the shell as shown in the screenshot. It is not possible to run the cells in this notebook.
  &lt;div style=&quot;clear: both;&quot;&gt;&lt;/div&gt;
  &lt;img src=&quot;../../material/codespace-shell.png&quot; style=&quot;max-width: 100%; border-radius: 5px;&quot;&gt;</code></pre>
  </div>
  <p>The status command provides an overview of the current state of the project and the files in the three sections. Therefore, you will need to run <code>git status</code> regularly.</p>
  <p><strong>Note</strong>: The comments after the hashtag (#) are ignored.</p>
  <div class="sourceCode" id="cb3"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Check the status of the project</span></span>
  <span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>git status</span></code></pre></div>
  <details>
  <summary>
  Check
  </summary>
  <p>
  The <code>git status</code> command should print something like the following:
  </p>
  <pre class="highlight">
  <code>
  On branch main
  Your branch is up to date with 'origin/main'.

  nothing to commit, working tree clean
  </code>
  </pre>
  <p>The last line indicates that there are no changes in the staging area (nothing to commit). The working directory has the same content as the last version in the git repository (working tree clean).</p>
  </details>
  <h2 id="part-2-create-stage-and-commit-changes">Part 2: Create, stage, and commit changes <a id="commit"></a></h2>
  <p>Next, we modify files (state: <strong>untracked</strong>/<strong>modified</strong>), mark them to be in the next commit (state: <strong>staged</strong>), and create the first version (state: <strong>committed</strong>). This corresponds to the three sections of a Git project.</p>
  <p><strong>Task</strong>: Open the <code>README.md</code> file in the colrev repository (<code>shift</code> + double click to open in a separate tab) and add your name to the project citation (<code># Citing CoLRev</code>section).</p>
  <div class="sourceCode" id="cb4"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Check the `git status` between each command</span></span>
  <span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>git status</span></code></pre></div>
  <p><strong>Task</strong>: Open the <code>CONTRIBUTING.md</code> file and change it.</p>
  <p>The <code>git status</code> should now show two files with changes in the working directory (state: <strong>modified</strong>)</p>
  <p>We decide that the changes in the <code>README.md</code> file should be <strong>staged</strong> for the next commit. The changes in the <code>CONTRIBUTING.md</code> file are no longer needed.</p>
  <p><strong>Task</strong>: Use the commands suggested by <code>git status</code> to accomplish this.</p>
  <p>This means that changes in the README.md are <strong>staged</strong> (to be committed).</p>
  <details>
  <summary>
  Check
  </summary>
  <p>
  The <code>git status</code> should now display:
  </p>
  <pre class="highlight">
  <code>
  On branch main
  Your branch is up to date with 'origin/main'.

  Changes to be committed:
    (use "git restore --staged &lt;file&gt;..." to unstage)
      modified:   README.md
  </code>
  </pre>
  </details>
  <p>To <strong>commit</strong> the changes, we run</p>
  <div class="sourceCode" id="cb5"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>git commit <span class="op">-</span>m <span class="st">&#39;add contributor&#39;</span></span></code></pre></div>
  <p>The <code>-m 'add contributor'</code> adds a short summary message, which is expected for every commit.</p>
  <details>
  <summary>
  Check
  </summary>
  <p><code>git status</code> should reflect your expected state of files in the three Git sections.</p>
  </details>
  <h2 id="part-3-undo-committed-changes">Part 3: Undo committed changes <a id="undo"></a></h2>
  <p>To undo the last commit, we can simply run:</p>
  <div class="sourceCode" id="cb6"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>git reset <span class="op">--</span>soft HEAD<span class="op">~</span><span class="dv">1</span></span></code></pre></div>
  <p>You should now have the <code>README.md</code> file in the staging area again.</p>
  <p><strong>Note</strong>: the <code>HEAD~1</code> refers to the last commit.</p>
  <p><strong>Task</strong>: Run <code>git status</code> to see the changes.</p>
  <p>We decide to discard our changes.</p>
  <p><strong>Task</strong>: Use the commands suggested by <code>git status</code> to do that.</p>
  <details>
  <summary>
  Check
  </summary>
  <p>
  The <code>git status</code> should show the following:
  </p>
  <pre class="highlight">
  <code>
  On branch main
  nothing to commit, working tree clean
  </code>
  </pre>
  </details>
  <p>To analyze the specific changes, open the Git GUI:</p>
  <p><img src="../../material/codespace-git-viewer.png" width="820"/></p>
  <h2 id="part-4-create-atomic-commits">Part 4: Create atomic commits <a id="atomic"></a></h2>
  <p>It is good practice to create <strong>atomic commits</strong>, i.e., small changes that belong together. One should avoid large commits that modify many unrelated parts of the code base and pursue different objectives.</p>
  <p>Analyze the following commits and discuss which ones are atomic and which ones combine changes that do not belong together (i.e., should be in separate commits). In addition, check the commit message (short summary at the beginning). Does the message clearly summarize the changes?</p>
  <p><a href="https://github.com/CoLRev-Environment/colrev/commit/a0c9043784f9342136d2ab214513688769669199" target="_blank">Commit 1</a></p>
  <details>
  <summary>
  Solution
  </summary>
  <p>Atomic commit, ok.</p>
  </details>
  <p><a href="https://github.com/CoLRev-Environment/colrev/commit/5288e92083b6df546d7c8fd590df3e968a909114" target="_blank">Commit 2</a></p>
  <details>
  <summary>
  Solution
  </summary>
  <p>Relatively atomic. There are a few changes beyond <code>compute_language()</code>. May be improved.</p>
  </details>
  <p><a href="https://github.com/CoLRev-Environment/colrev/commit/ba08d4242f48ec96b4fa8cfd053ee3781e32231f" target="_blank">Commit 3</a></p>
  <details>
  <summary>
  Solution
  </summary>
  <p>Many files changed. Changes not related to each other. Message refers to refactoring and testing, but the commit also adds functionality.</p>
  </details>
  <p><a href="https://github.com/CoLRev-Environment/colrev/commit/ce9850f805a140692866970c92557833e6befa0b" target="_blank">Commit 4</a></p>
  <details>
  <summary>
  Solution
  </summary>
  <p>Many files changed, but the changes belong together. ok.</p>
  </details>
  <p><a href="https://github.com/CoLRev-Environment/colrev/commit/93fc7e851d2ba3fc95cc3190b6b71dc4a907c96b" target="_blank">Commit 5</a></p>
  <details>
  <summary>
  Solution
  </summary>
  <p>Atomic commit, ok.</p>
  <p>It is ok to combine functionality, tests, and docs that belong together in one commit!</p>
  </details>
  <p><strong>Optional</strong>: If you have the time, you may check the <a href="https://www.conventionalcommits.org/en/v1.0.0/">Conventional Commits</a>{: target=“_blank”} specification.</p>
  <p>To create atomic commits, you may need to <strong>add specific lines of code that should go into a commit</strong>, leaving other changes in the working directory.</p>
  <p>The changes are provided in the <a href="rec_dict.patch">rec_dict.patch</a> file, which must be placed in the project’s working directory. To apply it, run:</p>
  <div class="sourceCode" id="cb7"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Suggests to rename the method but also introduces unrelated changes.</span></span>
  <span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>git <span class="bu">apply</span> rec_dict.patch</span>
  <span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Different files were modified by the patch</span></span>
  <span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a>git status</span></code></pre></div>
  <p><strong>Task</strong>: Use the Git GUI to check the changes that were introduced by the patch.</p>
  <p>In the following, we would like to add <strong>only</strong> the changes in lines related to the <code>load_records_dict</code> method and the <code>skip_notification</code> parameter (using <code>-p</code> for a partial <code>git add</code>):</p>
  <div class="sourceCode" id="cb8"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Add specific lines of code from the colrev/dataset.py</span></span>
  <span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a><span class="co"># using y/n to add or skip (confirming with ENTER)</span></span>
  <span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>git add <span class="op">-</span>p colrev<span class="op">/</span>dataset.py</span></code></pre></div>
  <p><strong>Task</strong>: Check whether the correct lines were added! Create a commit containing the relevant changes. Afterward, discard the remaining changes.</p>
  <h2 id="part-5-undo-changes-advanced">Part 5: Undo changes (advanced) <a id="undo"></a></h2>
  <p>To <strong>undo committed changes</strong>, there several options:</p>
  <ul>
  <li>Revert the commit, i.e., create a new commit to undo changes: <code>git revert COMMIT_SHA --no-edit</code></li>
  <li>Undo the commit and leave the changes in the staging area: <code>git reset --soft COMMIT_SHA</code> (*)</li>
  <li>Stage changes, and run <code>git commit --amend</code> to modify the last commit (*)</li>
  </ul>
  <p>If you have the time, try the different undo operations in the session.</p>
  <p>(*) Important: only amend commits that are not yet shared with the team. Otherwise, a revert is preferred.</p>
  <div style="border: 2px solid #03a9f4; padding: 10px; background-color: #b3e5fc; color: #01579b; border-radius: 5px; display: inline-block; width:730px;">
  <pre><code>&lt;strong&gt;Info&lt;/strong&gt; Once you have committed changes, Git takes care of the data and it is very hard to lose the data. Uncommitted data can be lost more easily. Therefore, commit often!&lt;br&gt;&lt;br&gt; Even if you run &lt;code&gt;git reset --hard ...&lt;/code&gt;, you can still recover commits using &lt;code&gt;git reflog&lt;/code&gt;. Committed data will only be lost permanently if you run &lt;code&gt;git reflog expire --expire=now --all&lt;/code&gt; and &lt;code&gt;git gc --prune=now --aggressive&lt;/code&gt;. If the commits are already on GitHub, you would need &lt;code&gt;git push --force&lt;/code&gt; and the changes may also be synchronized in other local repositories. &lt;br&gt;&lt;br&gt;Avoid options like &lt;code&gt;--force&lt;/code&gt;, &lt;code&gt;--hard&lt;/code&gt;, or &lt;code&gt;--aggressive&lt;/code&gt;. Use them only if you know what you are doing.</code></pre>
  </div>
  <h2 id="wrap-up">Wrap-up <a id="wrap-up"></a></h2>
  <p>🎉🎈 You have completed the Git commit notebook - good work! 🎈🎉</p>
  <p>In this notebook, we have learned to</p>
  <ul>
  <li>Clone a repository and check the <code>git status</code></li>
  <li>Create, stage, and commit changes using <code>git add</code>, <code>git commit</code> and <code>git restore</code></li>
  <li>Create atomic commits</li>
  <li>Undo changes</li>
  <li>Navigate VisualStudio Code on GitHub Codespaces</li>
  </ul>
  <p>Remember to delete your codespace <a href="https://github.com/codespaces">here</a>{: target=“_blank”} (see <a href="codespaces.ipynb">instructions</a>).</p>
</body>
</html>
